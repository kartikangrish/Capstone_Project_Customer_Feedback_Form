<div class="container mt-4">
  <div class="d-flex justify-content-between align-items-center mb-4">
    <div>
      <h2 class="fw-bold text-navy"><i class="bi bi-speedometer2 me-2"></i>Feedback Dashboard</h2>
      <p class="text-muted">Analyze customer sentiments and product ratings</p>
    </div>
    <a routerLink="/feedback-form" class="btn btn-primary">
      <i class="bi bi-plus-circle me-1"></i> New Feedback
    </a>
  </div>

  <div class="card custom-card mb-4">
    <div class="card-body bg-light rounded shadow-sm">
      <div class="row align-items-center">
        <div class="col-md-4">
          <label class="form-label fw-bold"><i class="bi bi-filter-right me-1"></i> Filter by Rating</label>
          <select class="form-select shadow-sm" [(ngModel)]="ratingFilter" (change)="applyFilter()">
            <option value="All">All Ratings (Show Everything)</option>
            <option value="5">⭐⭐⭐⭐⭐ (5 Stars)</option>
            <option value="4">⭐⭐⭐⭐ (4 Stars)</option>
            <option value="3">⭐⭐⭐ (3 Stars)</option>
            <option value="2">⭐⭐ (2 Stars)</option>
            <option value="1">⭐ (1 Star)</option>
          </select>
        </div>
        <div class="col-md-8 text-end pt-4">
          <span class="badge bg-secondary p-2">Showing {{filteredFeedback.length}} results</span>
        </div>
      </div>
    </div>
  </div>

  <div class="card custom-card shadow-sm">
    <div class="table-responsive">
      <table class="table table-hover align-middle mb-0">
        <thead class="table-dark">
          <tr>
            <th class="ps-4">Product Name</th>
            <th>Customer</th>
            <th>Rating</th>
            <th>Comment</th>
            <th class="text-center">Status</th>
          </tr>
        </thead>
        <tbody>
          <tr *ngIf="isLoading">
            <td colspan="5" class="text-center py-5">
              <div class="spinner-border text-primary" role="status"></div>
              <p class="mt-2">Loading data from backend...</p>
            </td>
          </tr>

          <tr *ngFor="let item of filteredFeedback">
            <td class="ps-4 fw-bold text-primary">{{ item.product.name }}</td>
            <td>
              <div class="d-flex align-items-center">
                <i class="bi bi-person-circle me-2 text-secondary"></i>
                {{ item.customer.firstName }}
              </div>
            </td>
            <td>
              <span class="badge rounded-pill" [ngClass]="getRatingClass(item.rating)">
                {{ item.rating }} <i class="bi bi-star-fill small"></i>
              </span>
            </td>
            <td class="text-truncate" style="max-width: 250px;">
              <small class="text-muted italic">"{{ item.comment }}"</small>
            </td>
            <td class="text-center">
              <i class="bi bi-check-circle-fill text-success" title="Verified"></i>
            </td>
          </tr>

          <tr *ngIf="!isLoading && filteredFeedback.length === 0">
            <td colspan="5" class="text-center py-5 text-muted">
              <i class="bi bi-inbox fs-1 d-block mb-2"></i>
              No feedback found matching this rating.
            </td>
          </tr>
        </tbody>
      </table>
    </div>
  </div>
</div>